- [x] Perform a semantic codebase search to map out all code paths where context size (`NumCtx`) is set, overridden, or passed to the backend, and where the GGUF context length is read and compared.
- [x] Identify all relevant code locations and logic for `NumCtx` initialization, modification, and usage.
- [x] Find where the GGUF context length is loaded and how it is used to limit or set the effective context.
- [x] Document the flow from configuration/env/CLI to backend invocation, including any runtime adjustments.
- [x] Highlight where changes would be needed to support dynamic context sizing up to the model's maximum.
- [x] Create a detailed plan for dynamic `NumCtx` sizing, including a Mermaid diagram.
- [x] Write the issue and plan to `ISSUE.md` and `PLAN.md`.
- [x] Implement the dynamic `NumCtx` sizing.
- [x] Formulate a plan for updating tests.
- [x] Implement the test updates.
- [x] Investigate `NumPredict = -1` behavior and its effect on context calculation.
- [ ] Investigate and resolve `NumCtx` scaling and preservation failures in `sched_test.go`.
- [ ] Fix `NumCtx` scaling in `server/sched.go` (`pickBestFullFitByLibrary` and `pickBestPartialFitByLibrary`).